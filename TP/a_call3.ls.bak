/PROG  A_CALL3
/ATTR
OWNER		= MNEDITOR;
COMMENT		= "";
PROG_SIZE	= 5681;
CREATE		= DATE 17-06-02  TIME 15:02:20;
MODIFIED	= DATE 17-11-20  TIME 21:36:54;
FILE_NAME	= A_CALL1;
VERSION		= 0;
LINE_COUNT	= 309;
MEMORY_SIZE	= 6117;
PROTECT		= READ_WRITE;
TCD:  STACK_SIZE	= 0,
      TASK_PRIORITY	= 50,
      TIME_SLICE	= 0,
      BUSY_LAMP_OFF	= 0,
      ABORT_REQUEST	= 0,
      PAUSE_REQUEST	= 0;
DEFAULT_GROUP	= *,*,1,*,*;
CONTROL_CODE	= 00000000 00000000;
/APPL
  ARC : TRUE ; 
  ARC Welding Equipment : 1,*,*,*,*;

MPAS ;
MPAS_NUM_PASSES        : 0;
MPAS_LAST_PASS         : 0;
MPAS_CURRENT_PASS      : 0;
MPAS_STATUS_PASS       : 0;
/MN
   1:  !****************************** ;
   2:  !**** LASER CALIBRATION ;
   3:  !****************************** ;
   4:  OVERRIDE=100% ;
   5:   ;
   6:  !If Robot is not folded ;
   7:  PR[120]=JPOS    ;
   8:  IF (PR[120,2]<70) THEN ;
   9:  IF (PR[185,1]=1) THEN ;
  10:  CALL FOLD1    ;
  11:  ELSE ;
  12:  CALL FOLD3    ;
  13:  ENDIF ;
  14:  ENDIF ;
  15:   ;
  16:   ;
  17:  UTOOL_NUM=9 ;
  18:  UFRAME_NUM=8 ;
  19:   ;
  20:  !------- TOOL WIDTH ------- ;
  21:       ;
  22:   ;
  23:  !------- SET ZERO TOOL ------- ;
  24:  PR[180]=LPOS    ;
  25:  PR[180,1]=0    ;
  26:  PR[180,2]=0    ;
  27:  PR[180,3]=0    ;
  28:  PR[180,4]=0    ;
  29:  PR[180,5]=0    ;
  30:  PR[180,6]=0    ;
  31:   ;
  32:  UTOOL[9]=PR[180] ;
  33:   ;
  34:  ! to get correct userframe ;
  35:  PR[180,6]=PR[185,2]    ;
  36:  UFRAME[8]=PR[180] ;
  37:  PR[180,6]=0    ;
  38:   ;
  39:  !  Setting I/O 's ;
  40:  ! laser door ;
  41:  R[135]=PR[185,3]    ;
  42:  R[136]=PR[185,4]    ;
  43:  R[137]=PR[185,5]    ;
  44:   ;
  45:  RO[R[135]]=OFF ;
  46:  DO[R[136]]=OFF ;
  47:   ;
  48:  !- SAFE POINT IF PROGRAM RESTART ;
  49:   ;
  50:  PR[126]=LPOS    ;
  51:  IF (PR[126,1]>160),JMP LBL[120] ;
  52:  PR[126,1]=200    ;
  53:   ;
  54:L PR[126] 50mm/sec FINE    ;
  55:   ;
  56:   ;
  57:  !------- UNFOLD POINT ------- ;
  58:  LBL[120] ;
  59:  PR[120]=JPOS    ;
  60:  PR[120,1]=PR[185,2]    ;
  61:  PR[120,7]=1000    ;
  62:J PR[120] 50% FINE    ;
  63:   ;
  64:  LBL[121] ;
  65:  PR[121]=JPOS    ;
  66:  PR[121,2]=90    ;
  67:  PR[121,3]=(-80)    ;
  68:  PR[121,4]=0    ;
  69:  PR[121,5]=30    ;
  70:  PR[121,6]=0    ;
  71:   ;
  72:J PR[121] 50% FINE    ;
  73:   ;
  74:  PR[122]=PR[121]    ;
  75:  PR[122,5]=(-100)    ;
  76:J PR[122] 50% FINE    ;
  77:   ;
  78:  !****************************** ;
  79:  !**** SENSING ;
  80:  !****************************** ;
  81:   ;
  82:   ;
  83:  !****************************** ;
  84:  !------------ X1 --------------- ;
  85:   ;
  86:  PR[123]=LPOS    ;
  87:  PR[123,1]=532    ;
  88:  IF (PR[185,1]=1) THEN ;
  89:  PR[123,2]=100-PR[123,7]    ;
  90:  ELSE ;
  91:  PR[123,2]=100+PR[123,7]    ;
  92:  ENDIF ;
  93:  PR[123,3]=(-337)    ;
  94:  PR[123,4]=(-90)    ;
  95:  PR[123,5]=0    ;
  96:  PR[123,6]=90    ;
  97:   ;
  98:L PR[123] 100mm/sec FINE    ;
  99:  RO[R[135]]=ON ;
 100:  DO[R[136]]=ON ;
 101:  WAIT   1.00(sec) ;
 102:  !Sense in Tool direction ;
 103:  UFRAME_NUM=9 ;
 104:  UTOOL_NUM=3 ;
 105:  PR[120]=LPOS    ;
 106:   ;
 107:  UFRAME[6]=PR[120] ;
 108:   ;
 109:  UFRAME_NUM=6 ;
 110:   ;
 111:  PR[161]=LPOS    ;
 112:  PR[161,3]=PR[161,3]-20    ;
 113:  SKIP CONDITION DI[R[137]]=ON    ;
 114:   ;
 115:  OVERRIDE=50% ;
 116:L PR[161] 1mm/sec FINE Skip,LBL[991],PR[170]=LPOS    ;
 117:   ;
 118:  !move into block ;
 119:  PR[162]=PR[170]    ;
 120:  PR[162,3]=PR[162,3]-1.5    ;
 121:L PR[162] 50mm/sec FINE    ;
 122:   ;
 123:  !Sense X value ;
 124:  UFRAME_NUM=8 ;
 125:  UTOOL_NUM=9 ;
 126:  PR[161]=LPOS    ;
 127:  PR[161,2]=PR[161,2]-15    ;
 128:L PR[161] 100mm/sec FINE    ;
 129:   ;
 130:  PR[162]=PR[161]    ;
 131:  PR[162,2]=PR[162,2]+20    ;
 132:  SKIP CONDITION DI[R[137]]=ON    ;
 133:   ;
 134:  OVERRIDE=50% ;
 135:L PR[162] 1mm/sec FINE Skip,LBL[991],PR[171]=LPOS    ;
 136:   ;
 137:   ;
 138:  !****************************** ;
 139:  !------------ Y1 --------------- ;
 140:  PR[161]=LPOS    ;
 141:  PR[161,2]=PR[161,2]+5    ;
 142:  PR[161,3]=PR[161,3]+15    ;
 143:   ;
 144:L PR[161] 50mm/sec FINE    ;
 145:   ;
 146:  PR[163]=PR[161]    ;
 147:  PR[163,3]=PR[163,3]-20    ;
 148:  SKIP CONDITION DI[R[137]]=ON    ;
 149:   ;
 150:  OVERRIDE=50% ;
 151:L PR[163] 1mm/sec FINE Skip,LBL[991],PR[173]=LPOS    ;
 152:   ;
 153:   ;
 154:  !------------ X2 --------------- ;
 155:   ;
 156:  PR[124]=PR[123]    ;
 157:  IF (PR[185,1]=1) THEN ;
 158:  PR[124,2]=(-100)-PR[124,7]    ;
 159:  ELSE ;
 160:  PR[124,2]=(-100)+PR[124,7]    ;
 161:  ENDIF ;
 162:  PR[124,4]=PR[123,4]*(-1)    ;
 163:  PR[124,5]=0    ;
 164:  PR[124,6]=PR[123,6]*(-1)    ;
 165:   ;
 166:J PR[121] 75% CNT50    ;
 167:   ;
 168:J PR[124] 100% FINE    ;
 169:  WAIT   1.00(sec) ;
 170:   ;
 171:  !Sense in Tool direction ;
 172:  UFRAME_NUM=9 ;
 173:  UTOOL_NUM=3 ;
 174:  PR[120]=LPOS    ;
 175:   ;
 176:  UFRAME[6]=PR[120] ;
 177:   ;
 178:  UFRAME_NUM=6 ;
 179:   ;
 180:  PR[161]=LPOS    ;
 181:  PR[161,3]=PR[161,3]-20    ;
 182:  SKIP CONDITION DI[R[137]]=ON    ;
 183:   ;
 184:  OVERRIDE=50% ;
 185:L PR[161] 1mm/sec FINE Skip,LBL[991],PR[170]=LPOS    ;
 186:   ;
 187:  !move into block ;
 188:  PR[162]=PR[170]    ;
 189:  PR[162,3]=PR[162,3]-1.5    ;
 190:L PR[162] 50mm/sec FINE    ;
 191:   ;
 192:  !Sense X value ;
 193:  UFRAME_NUM=8 ;
 194:  UTOOL_NUM=9 ;
 195:  PR[170]=LPOS    ;
 196:  PR[161]=LPOS    ;
 197:  PR[161]=LPOS    ;
 198:  PR[161,2]=PR[161,2]+15    ;
 199:L PR[161] 100mm/sec FINE    ;
 200:   ;
 201:  PR[162]=PR[161]    ;
 202:  PR[162,2]=PR[162,2]-20    ;
 203:  SKIP CONDITION DI[R[137]]=ON    ;
 204:   ;
 205:  OVERRIDE=50% ;
 206:L PR[162] 1mm/sec FINE Skip,LBL[991],PR[172]=LPOS    ;
 207:   ;
 208:   ;
 209:  !****************************** ;
 210:  !------------ Y2 --------------- ;
 211:   ;
 212:  PR[161]=LPOS    ;
 213:  PR[161,2]=PR[161,2]-5    ;
 214:  PR[161,3]=PR[161,3]+15    ;
 215:L PR[161] 50mm/sec FINE    ;
 216:   ;
 217:  PR[163]=PR[161]    ;
 218:  PR[163,3]=PR[163,3]-20    ;
 219:  SKIP CONDITION DI[R[137]]=ON    ;
 220:   ;
 221:  OVERRIDE=50% ;
 222:L PR[163] 1mm/sec FINE Skip,LBL[991],PR[174]=LPOS    ;
 223:   ;
 224:  PR[180,1]=(((PR[172,2]-PR[171,2]-R[167])/2-1.2)*1) ;
 225:  PR[180,2]=((PR[173,3]-PR[174,3])/2) ;
 226:   ;
 227:  !****************************** ;
 228:  !------------ Z2 --------------- ;
 229:   ;
 230:  PR[125]=LPOS    ;
 231:  PR[125,1]=250    ;
 232:   ;
 233:  IF (PR[185,1]=1) THEN ;
 234:  PR[125,2]=PR[125,7]*(-1)    ;
 235:  ELSE ;
 236:  PR[125,2]=PR[125,7]    ;
 237:  ENDIF ;
 238:   ;
 239:  PR[125,3]=25    ;
 240:  PR[125,4]=(-180)    ;
 241:  PR[125,5]=0    ;
 242:  PR[125,6]=0    ;
 243:   ;
 244:J PR[125] 100% FINE    ;
 245:  WAIT    .50(sec) ;
 246:   ;
 247:  PR[165]=PR[125]    ;
 248:  PR[165,3]=PR[165,3]-20    ;
 249:  SKIP CONDITION DI[R[137]]=ON    ;
 250:   ;
 251:  OVERRIDE=50% ;
 252:L PR[165] 1mm/sec FINE Skip,LBL[991],PR[175]=LPOS    ;
 253:   ;
 254:  OVERRIDE=100% ;
 255:   ;
 256:   ;
 257:  PR[180,3]=(PR[175,3]-PR[174,3]-PR[180,2]) ;
 258:   ;
 259:  !****************************** ;
 260:  !**** SET TOOL POINT ;
 261:  !****************************** ;
 262:   ;
 263:  !----- ;
 264:  PR[180,4]=(-180)    ;
 265:  PR[180,5]=(-13)    ;
 266:  PR[180,6]=0    ;
 267:   ;
 268:  UTOOL[3]=PR[180] ;
 269:   ;
 270:  RO[R[135]]=OFF ;
 271:  DO[R[136]]=OFF ;
 272:J PR[121] 50% CNT50    ;
 273:   ;
 274:   ;
 275:  JMP LBL[9999] ;
 276:   ;
 277:  !****************************** ;
 278:  !**** ERROR HANDLING ;
 279:  !****************************** ;
 280:  LBL[991] ;
 281:  RO[R[135]]=OFF ;
 282:  DO[R[136]]=OFF ;
 283:  R[162]=603    ;
 284:   ;
 285:  PR[126]=LPOS    ;
 286:  PR[126,1]=PR[126,1]+30    ;
 287:   ;
 288:L PR[126] 50mm/sec FINE    ;
 289:J PR[121] 50% CNT50    ;
 290:  ABORT ;
 291:   ;
 292:   ;
 293:  LBL[9999] ;
 294:  OVERRIDE=100% ;
 295:  IF (PR[185,1]=1) THEN ;
 296:  CALL FOLD1    ;
 297:  !Calibration OK ;
 298:  R[215]=6050    ;
 299:  ELSE ;
 300:  CALL FOLD3    ;
 301:  !Calibration OK ;
 302:  R[216]=6050    ;
 303:  ENDIF ;
 304:  UTOOL_NUM=1 ;
 305:  UFRAME_NUM=1 ;
 306:  !Calibration OK ;
 307:  R[215]=6050    ;
 308:   ;
 309:   ;
/POS
/END
