/PROG  A_CHKL3
/ATTR
OWNER		= MNEDITOR;
COMMENT		= "";
PROG_SIZE	= 6527;
CREATE		= DATE 17-06-02  TIME 15:23:46;
MODIFIED	= DATE 17-11-21  TIME 19:09:34;
FILE_NAME	= A_CHKL1;
VERSION		= 0;
LINE_COUNT	= 347;
MEMORY_SIZE	= 6939;
PROTECT		= READ_WRITE;
TCD:  STACK_SIZE	= 0,
      TASK_PRIORITY	= 50,
      TIME_SLICE	= 0,
      BUSY_LAMP_OFF	= 0,
      ABORT_REQUEST	= 0,
      PAUSE_REQUEST	= 0;
DEFAULT_GROUP	= *,*,1,*,*;
CONTROL_CODE	= 00000000 00000000;
/APPL
  ARC : TRUE ; 
  ARC Welding Equipment : 1,*,*,*,*;

MPAS ;
MPAS_NUM_PASSES        : 0;
MPAS_LAST_PASS         : 0;
MPAS_CURRENT_PASS      : 0;
MPAS_STATUS_PASS       : 0;
/MN
   1:  !****************************** ;
   2:  !**** LASER CHECK ;
   3:  !****************************** ;
   4:  OVERRIDE=100% ;
   5:  !  Setting I/O 's ;
   6:  ! laser door ;
   7:  R[135]=PR[185,3]    ;
   8:  R[136]=PR[185,4]    ;
   9:  R[137]=PR[185,5]    ;
  10:   ;
  11:  UTOOL_NUM=3 ;
  12:  UFRAME_NUM=8 ;
  13:  !------- TOOL WIDTH ------- ;
  14:  R[167]=30    ;
  15:   ;
  16:  RO[R[135]]=OFF ;
  17:  DO[R[136]]=OFF ;
  18:   ;
  19:   ;
  20:  PR[126]=LPOS    ;
  21:  IF (PR[126,1]>160),JMP LBL[120] ;
  22:  PR[126,1]=200    ;
  23:   ;
  24:L PR[126] 50mm/sec FINE    ;
  25:   ;
  26:   ;
  27:  !------- UNFOLD POINT ------- ;
  28:  LBL[120] ;
  29:  PR[120]=JPOS    ;
  30:  PR[120,1]=PR[185,2]    ;
  31:  PR[120,7]=1000    ;
  32:J PR[120] 50% FINE    ;
  33:   ;
  34:  LBL[121] ;
  35:  PR[121]=JPOS    ;
  36:  PR[121,1]=PR[185,2]    ;
  37:  PR[121,2]=90    ;
  38:  PR[121,3]=(-80)    ;
  39:  PR[121,4]=0    ;
  40:  PR[121,5]=30    ;
  41:  PR[121,6]=0    ;
  42:   ;
  43:J PR[121] 50% FINE    ;
  44:   ;
  45:  PR[122]=PR[121]    ;
  46:  PR[122,5]=(-100)    ;
  47:J PR[122] 50% FINE    ;
  48:   ;
  49:  RO[R[135]]=ON ;
  50:  DO[R[136]]=ON ;
  51:   ;
  52:  !****************************** ;
  53:  !**** SENSING ;
  54:  !****************************** ;
  55:   ;
  56:   ;
  57:  !------------ X1 --------------- ;
  58:   ;
  59:  PR[125]=LPOS    ;
  60:  PR[125,1]=185    ;
  61:  PR[125,2]=PR[125,2]    ;
  62:  PR[125,3]=(-336)    ;
  63:  PR[125,4]=60    ;
  64:  PR[125,5]=0    ;
  65:  PR[125,6]=90    ;
  66:   ;
  67:  PR[124]=PR[125]    ;
  68:  PR[124,4]=0    ;
  69:  PR[124,5]=60    ;
  70:  PR[124,6]=0    ;
  71:   ;
  72:  PR[123]=PR[125]    ;
  73:  PR[123,4]=(-60)    ;
  74:  PR[123,5]=0    ;
  75:  PR[123,6]=(-90)    ;
  76:   ;
  77:L PR[125] 20mm/sec FINE    ;
  78:  PR[160]=PR[125]    ;
  79:  PR[160,1]=PR[160,1]-20    ;
  80:  SKIP CONDITION DI[R[137]]=ON    ;
  81:  IF DI[R[137]]=ON,JMP LBL[991] ;
  82:   ;
  83:  OVERRIDE=50% ;
  84:L PR[160] 1mm/sec FINE Skip,LBL[991],PR[170]=LPOS    ;
  85:   ;
  86:  OVERRIDE=100% ;
  87:   ;
  88:  !------------ X2 --------------- ;
  89:   ;
  90:L PR[124] 20mm/sec FINE    ;
  91:  PR[161]=PR[124]    ;
  92:  PR[161,1]=PR[161,1]-20    ;
  93:  SKIP CONDITION DI[R[137]]=ON    ;
  94:  IF DI[R[137]]=ON,JMP LBL[991] ;
  95:   ;
  96:  OVERRIDE=50% ;
  97:L PR[161] 1mm/sec FINE Skip,LBL[991],PR[171]=LPOS    ;
  98:   ;
  99:  OVERRIDE=100% ;
 100:   ;
 101:  !------------ X3 --------------- ;
 102:   ;
 103:L PR[123] 20mm/sec FINE    ;
 104:  PR[162]=PR[123]    ;
 105:  PR[162,1]=PR[162,1]-20    ;
 106:  SKIP CONDITION DI[R[137]]=ON    ;
 107:  IF DI[R[137]]=ON,JMP LBL[991] ;
 108:   ;
 109:  OVERRIDE=50% ;
 110:L PR[162] 1mm/sec FINE Skip,LBL[991],PR[172]=LPOS    ;
 111:   ;
 112:  OVERRIDE=100% ;
 113:   ;
 114:  !------------ CHECK X ---------- ;
 115:   ;
 116:  PR[181,1]=PR[170,1]-PR[171,1]    ;
 117:  PR[181,2]=PR[171,1]-PR[172,1]    ;
 118:  PR[181,3]=PR[172,1]-PR[170,1]    ;
 119:   ;
 120:  IF (PR[181,1]<0),PR[181,1]=(PR[181,1]*(-1)) ;
 121:  IF (PR[181,2]<0),PR[181,2]=(PR[181,2]*(-1)) ;
 122:  IF (PR[181,3]<0),PR[181,3]=(PR[181,3]*(-1)) ;
 123:   ;
 124:  PR[181,4]=PR[181,1]    ;
 125:  IF (PR[181,2]>PR[181,4]),PR[181,4]=(PR[181,2]) ;
 126:  IF (PR[181,3]>PR[181,4]),PR[181,4]=(PR[181,3]) ;
 127:   ;
 128:  !****************************** ;
 129:   ;
 130:  !------------ Z1 --------------- ;
 131:   ;
 132:  PR[125,4]=90    ;
 133:  PR[125,5]=(-30)    ;
 134:  PR[125,6]=90    ;
 135:   ;
 136:  PR[124]=PR[125]    ;
 137:  PR[124,4]=0    ;
 138:  PR[124,5]=90    ;
 139:  PR[124,6]=0    ;
 140:   ;
 141:  PR[123]=PR[125]    ;
 142:  PR[123,4]=(-90)    ;
 143:  PR[123,5]=(-30)    ;
 144:  PR[123,6]=(-90)    ;
 145:   ;
 146:  PR[123,1]=PR[172,1]-2    ;
 147:  PR[124,1]=PR[123,1]    ;
 148:  PR[125,1]=PR[123,1]    ;
 149:   ;
 150:  IF (PR[185,1]=1) THEN ;
 151:  PR[123,2]=10-PR[123,7]    ;
 152:  ELSE ;
 153:  ENDIF ;
 154:  PR[124,2]=PR[123,2]    ;
 155:  PR[125,2]=PR[123,2]    ;
 156:   ;
 157:  PR[123,3]=(-326)    ;
 158:  PR[124,3]=PR[123,3]    ;
 159:  PR[125,3]=PR[123,3]    ;
 160:   ;
 161:L PR[123] 50mm/sec FINE    ;
 162:   ;
 163:  PR[163]=PR[123]    ;
 164:  PR[163,3]=PR[163,3]-20    ;
 165:  SKIP CONDITION DI[R[137]]=ON    ;
 166:  IF DI[R[137]]=ON,JMP LBL[991] ;
 167:   ;
 168:  OVERRIDE=50% ;
 169:L PR[163] 1mm/sec FINE Skip,LBL[991],PR[173]=LPOS    ;
 170:   ;
 171:  OVERRIDE=100% ;
 172:  !----- ;
 173:   ;
 174:   ;
 175:L PR[124] 50mm/sec FINE    ;
 176:   ;
 177:  PR[164]=PR[124]    ;
 178:  PR[164,3]=PR[164,3]-20    ;
 179:  SKIP CONDITION DI[R[137]]=ON    ;
 180:  IF DI[R[137]]=ON,JMP LBL[991] ;
 181:   ;
 182:  OVERRIDE=50% ;
 183:L PR[164] 1mm/sec FINE Skip,LBL[991],PR[174]=LPOS    ;
 184:   ;
 185:  OVERRIDE=100% ;
 186:   ;
 187:   ;
 188:L PR[125] 50mm/sec FINE    ;
 189:   ;
 190:  PR[165]=PR[125]    ;
 191:  PR[165,3]=PR[165,3]-20    ;
 192:  SKIP CONDITION DI[R[137]]=ON    ;
 193:  IF DI[R[137]]=ON,JMP LBL[991] ;
 194:   ;
 195:  OVERRIDE=50% ;
 196:L PR[165] 1mm/sec FINE Skip,LBL[991],PR[175]=LPOS    ;
 197:   ;
 198:  OVERRIDE=100% ;
 199:  !----- ;
 200:  !------------ CHECK Z ---------- ;
 201:   ;
 202:  PR[182,1]=PR[173,3]-PR[174,3]    ;
 203:  PR[182,2]=PR[174,3]-PR[175,3]    ;
 204:  PR[182,3]=PR[175,3]-PR[173,3]    ;
 205:   ;
 206:  IF (PR[182,1]<0),PR[182,1]=(PR[182,1]*(-1)) ;
 207:  IF (PR[182,2]<0),PR[182,2]=(PR[182,2]*(-1)) ;
 208:  IF (PR[182,3]<0),PR[182,3]=(PR[182,3]*(-1)) ;
 209:   ;
 210:  PR[182,4]=PR[182,1]    ;
 211:  IF (PR[182,2]>PR[182,4]),PR[182,4]=(PR[182,2]) ;
 212:  IF (PR[182,3]>PR[182,4]),PR[182,4]=(PR[182,3]) ;
 213:   ;
 214:   ;
 215:  !Y ;
 216:   ;
 217:  IF (PR[185,1]=1) THEN ;
 218:  PR[123,2]=25-PR[123,7]    ;
 219:  ELSE ;
 220:  PR[123,2]=PR[123,7]+25    ;
 221:  ENDIF ;
 222:  PR[124,2]=PR[123,2]    ;
 223:  PR[125,2]=PR[123,2]    ;
 224:   ;
 225:  PR[123,3]=(-336)    ;
 226:  PR[124,3]=PR[123,3]    ;
 227:  PR[125,3]=PR[123,3]    ;
 228:   ;
 229:   ;
 230:L PR[125] 10deg/sec FINE    ;
 231:   ;
 232:  PR[166]=PR[125]    ;
 233:  PR[166,2]=PR[166,2]-20    ;
 234:  SKIP CONDITION DI[R[137]]=ON    ;
 235:  IF DI[R[137]]=ON,JMP LBL[991] ;
 236:   ;
 237:  OVERRIDE=50% ;
 238:L PR[166] 1mm/sec FINE Skip,LBL[991],PR[176]=LPOS    ;
 239:   ;
 240:  OVERRIDE=100% ;
 241:  !----- ;
 242:   ;
 243:   ;
 244:L PR[124] 50mm/sec FINE    ;
 245:   ;
 246:  PR[167]=PR[124]    ;
 247:  PR[167,2]=PR[167,2]-20    ;
 248:  SKIP CONDITION DI[R[137]]=ON    ;
 249:  IF DI[R[137]]=ON,JMP LBL[991] ;
 250:   ;
 251:  OVERRIDE=50% ;
 252:L PR[167] 1mm/sec FINE Skip,LBL[991],PR[177]=LPOS    ;
 253:   ;
 254:  OVERRIDE=100% ;
 255:   ;
 256:   ;
 257:L PR[123] 50mm/sec FINE    ;
 258:   ;
 259:  PR[168]=PR[123]    ;
 260:  PR[168,2]=PR[168,2]-20    ;
 261:  SKIP CONDITION DI[R[137]]=ON    ;
 262:  IF DI[R[137]]=ON,JMP LBL[991] ;
 263:   ;
 264:  OVERRIDE=50% ;
 265:L PR[168] 1mm/sec FINE Skip,LBL[991],PR[178]=LPOS    ;
 266:   ;
 267:  OVERRIDE=100% ;
 268:  !----- ;
 269:  !------------ CHECK Y ---------- ;
 270:   ;
 271:  PR[183,1]=PR[176,2]-PR[177,2]    ;
 272:  PR[183,2]=PR[177,2]-PR[178,2]    ;
 273:  PR[183,3]=PR[178,2]-PR[176,2]    ;
 274:   ;
 275:  IF (PR[183,1]<0),PR[183,1]=(PR[183,1]*(-1)) ;
 276:  IF (PR[183,2]<0),PR[183,2]=(PR[183,2]*(-1)) ;
 277:  IF (PR[183,3]<0),PR[183,3]=(PR[183,3]*(-1)) ;
 278:   ;
 279:  PR[183,4]=PR[183,1]    ;
 280:  IF (PR[183,2]>PR[183,4]),PR[183,4]=(PR[183,2]) ;
 281:  IF (PR[183,3]>PR[183,4]),PR[183,4]=(PR[183,3]) ;
 282:   ;
 283:   ;
 284:   ;
 285:   ;
 286:  RO[R[135]]=OFF ;
 287:  DO[R[136]]=OFF ;
 288:   ;
 289:J PR[121] 50% CNT50    ;
 290:   ;
 291:  !****************************** ;
 292:  !**** RESULT HANDLING ;
 293:  !****************************** ;
 294:   ;
 295:  !getting worst result ;
 296:  R[172]=PR[181,4]    ;
 297:  IF (R[172]<PR[182,4]),R[172]=(PR[182,4]) ;
 298:  IF (R[172]<PR[183,4]),R[172]=(PR[183,4]) ;
 299:   ;
 300:  IF (R[172]<1.2) THEN ;
 301:  MESSAGE[laser calib ok] ;
 302:  IF (PR[185,1]=1) THEN ;
 303:  R[215]=6040    ;
 304:  ELSE ;
 305:  R[216]=6040    ;
 306:  ENDIF ;
 307:  ELSE ;
 308:  MESSAGE[laser calib not ok] ;
 309:  IF (PR[185,1]=1) THEN ;
 310:  R[215]=6041    ;
 311:  ELSE ;
 312:  R[216]=6040    ;
 313:  ENDIF ;
 314:  PAUSE ;
 315:  ENDIF ;
 316:  JMP LBL[9999] ;
 317:   ;
 318:   ;
 319:  !****************************** ;
 320:  !**** ERROR HANDLING ;
 321:  !****************************** ;
 322:  LBL[991] ;
 323:  RO[R[135]]=OFF ;
 324:  DO[R[136]]=OFF ;
 325:  R[162]=603    ;
 326:   ;
 327:  PR[126]=LPOS    ;
 328:  PR[126,1]=PR[126,1]+30    ;
 329:   ;
 330:L PR[126] 50mm/sec FINE    ;
 331:   ;
 332:J PR[121] 50% FINE    ;
 333:  PAUSE ;
 334:  ABORT ;
 335:   ;
 336:  LBL[9999] ;
 337:  OVERRIDE=100% ;
 338:  IF (PR[185,1]=1) THEN ;
 339:  CALL FOLD1    ;
 340:  ELSE ;
 341:  CALL FOLD3    ;
 342:  ENDIF ;
 343:  UTOOL_NUM=1 ;
 344:  UFRAME_NUM=1 ;
 345:   ;
 346:   ;
 347:   ;
/POS
/END
